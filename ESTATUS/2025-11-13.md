# ESTATUS - 2025-11-13

## Resumen
- **Finalizada la migración a arquitectura de empresa única (Single-Tenant).**
- La aplicación ha sido refactorizada para abandonar el modelo multi-empresa y centrarse en un solo `appId`.
- Se ha implementado un sistema de roles simple con **Administradores** y **Técnicos**.
- Los administradores ahora tienen una interfaz para gestionar los roles de los usuarios.
- Las reglas de seguridad de Firestore han sido actualizadas para reflejar el nuevo modelo.

## Cambios Técnicos
- **`src/App.jsx`:**
  - Eliminada toda la lógica y estados relacionados con `tenantId` y `isSuperAdmin`.
  - El rol del usuario (`admin` o `tecnico`) ahora se determina al iniciar sesión, consultando la colección `artifacts/{appId}/users`.
  - Los usuarios que inician sesión por primera vez se crean automáticamente con el rol de `tecnico`.
  - Todas las rutas de Firestore ahora usan la estructura `artifacts/{appId}/...`.
- **Componente `UserManagement`:**
  - Se ha añadido un nuevo componente y vista para que los administradores puedan listar todos los usuarios y cambiar sus roles.
- **Seguridad:**
  - Se han actualizado las reglas en `ESTATUS/REGLAS_FIRESTORE.md` para ser más robustas y específicas para el modelo de empresa única. Se protege la escritura de activos y la gestión de usuarios solo para administradores.

## Próximos Pasos / Modo de Uso
- **Gestión de Administradores:**
  1.  El **primer administrador** debe ser creado manualmente en Firestore creando la colección `admins` y añadiendo un documento con el UID del usuario como ID.
  2.  Una vez que existe un administrador, puede promover a otros usuarios al rol de `admin` desde la sección "Usuarios" en la propia aplicación.
- **Gestión de Técnicos:**
  1.  Un nuevo técnico solo necesita iniciar sesión una vez en la aplicación.
  2.  Aparecerá automáticamente en la lista de "Usuarios" con el rol de `tecnico`.
